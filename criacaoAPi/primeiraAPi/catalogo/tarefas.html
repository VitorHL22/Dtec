<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Book's On The Table</title>
    <link rel="stylesheet" href="tarefas.css">
    <link rel="shortcut icon" href="favicon.ico">
</head>

<body>
    <div class="left-section">
        <div class="logo">
            <img src="imagem logo.png" alt="BMW Logo" />
        </div>
        <nav>
            <ul>
                <li><a href="#">Gênero</a></li>
                <li><a href="#">Autor</a></li>
                <li><a href="#">Catálogo</a></li>
            </ul>
        </nav>
    </div>
    <div class="container">
        <h1>Meu Catálogo de Livros</h1>
        <p>Adicione livros e veja sua coleção!</p>

        <div class="header-buttons">
            <button id="btnListBooks">Listar Livros</button>
        </div>

        <div id="book-cards-container" class="cards-grid"></div>

        <h2>Adicionar Novo Livro</h2>
        <form id="addBookForm">
            <input type="text" id="bookTitle" placeholder="Título do Livro" required>
            <input type="text" id="bookAuthor" placeholder="Autor" required>
            <input type="number" id="bookYear" placeholder="Ano de Publicação" required>
            <input type="url" id="bookCover" placeholder="URL da Capa">
            <button type="submit">Adicionar Livro</button>
        </form>
    </div>
    // 
    <div id="editModal" class="modal">
        <div class="modal-content">
            <h2>Editar Livro</h2>
            <form id="editBookForm">
                <input type="hidden" id="editId">
                <label for="editTitle">Título:</label>
                <input type="text" id="editTitle" required>
                <label for="editAuthor">Autor:</label>
                <input type="text" id="editAuthor" required>
                <label for="editYear">Ano:</label>
                <input type="number" id="editYear" required>
                <label for="editCover">URL da Capa:</label>
                <input type="url" id="editCover">
                <div class="modal-buttons">
                    <button type="submit" class="btn-save">Salvar</button>
                    <button type="button" class="btn-cancel" id="btnCancelEdit">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <script>let books = [];

function renderBooks() {
    const container = document.getElementById("book-cards-container"); //pega a class
    container.innerHTML = ""; //para não duplicar livros

    books.forEach((book, index) => { //percorre a lista e procura o livro e a contagem dele
        const card = document.createElement("div");
        card.classList.add("book-card"); //para estilização
        //aq é o que vai mostrar no card
        card.innerHTML = `
            <img src="${book.cover || 'https://via.placeholder.com/150'}" alt="${book.title}">
            <p><strong>${book.title}</strong></p>
            <p>Autor: ${book.author}</p>
            <p>Ano: ${book.year}</p>
            <div class="card-buttons">
                <button class="btn-edit" onclick="editBook(${index})">Editar</button>
                <button class="btn-delete" onclick="deleteBook(${index})">Excluir</button>
            </div>
        `;
        //add dentro do card
        container.appendChild(card);
    });
}

document.getElementById("addBookForm").addEventListener("submit", function(e) {
    e.preventDefault(); //quando o formulário é enviado, executa a função.

    //pegar os valores
    const title = document.getElementById("bookTitle").value;
    const author = document.getElementById("bookAuthor").value;
    const year = document.getElementById("bookYear").value;
    const cover = document.getElementById("bookCover").value;

    books.push({ title, author, year, cover });
    renderBooks(); //att page

    this.reset(); //limpar
});

function deleteBook(index) {
    books.splice(index, 1); //funçao para deletar
    renderBooks();
}

function editBook(index) { //aq é para editar o livro
    document.getElementById("editModal").style.display = "flex";
    document.getElementById("editId").value = index;
    document.getElementById("editTitle").value = books[index].title;
    document.getElementById("editAuthor").value = books[index].author;
    document.getElementById("editYear").value = books[index].year;
    document.getElementById("editCover").value = books[index].cover;
}

document.getElementById("editBookForm").addEventListener("submit", function(e) {
    e.preventDefault();
    //só para substituir
    const index = document.getElementById("editId").value;
    books[index] = {
        title: document.getElementById("editTitle").value,
        author: document.getElementById("editAuthor").value,
        year: document.getElementById("editYear").value,
        cover: document.getElementById("editCover").value
    };

    renderBooks();
    document.getElementById("editModal").style.display = "none";
});

document.getElementById("btnCancelEdit").addEventListener("click", function() {
    document.getElementById("editModal").style.display = "none";
});

document.getElementById("btnListBooks").addEventListener("click", renderBooks);
</script>
<script src="tarefasapi.js"></script>
</body>

</html>